It looks like the build is failing because the JAR file can't be found at the specified location. This is a common issue when the path in the Dockerfile doesn't match the actual structure. Let me help you fix this:

## Issue Analysis

The error message indicates that Docker can't find the JAR file at `./target/ntier-application-1.0-SNAPSHOT.jar` relative to your build context. This is because your JAR is actually in the `3_middleware/target/` directory based on your tree structure.

## Solution

Let's modify your approach to correctly reference the JAR file:

1. First, update your Dockerfile in `3_middleware/dockerfile`:

```dockerfile
FROM openjdk:17-jdk-slim
WORKDIR /app

# Use the correct path relative to the build context
COPY target/ntier-application-1.0-SNAPSHOT.jar app.jar

EXPOSE 8080
CMD ["java", "-jar", "app.jar"]
```

2. Then modify your docker-compose.yml to set the proper build context:

```yaml
services:
  app:
    build:
      context: ./3_middleware
      dockerfile: dockerfile
    container_name: middleware_app
    ports:
      - "8080:8080"
    volumes:
      - ./3_middleware:/app
    depends_on:
      - database
```

The key change here is setting the `context: ./3_middleware` which makes Docker use that directory as the base for finding files referenced in the Dockerfile.

## Commands to Rebuild

Now, run these commands to rebuild:

```bash
# Stop any running containers
docker-compose down

# Rebuild with the updated configuration
docker-compose build app

# Start all services
docker-compose up -d
```

If you still encounter issues, you can verify the JAR's existence with:

```bash
ls -la 3_middleware/target/ntier-application-1.0-SNAPSHOT.jar
```

If the JAR isn't there, you might need to rebuild your Maven project before attempting the Docker build:

```bash
cd 3_middleware
mvn clean package
cd ..
docker-compose build app
docker-compose up -d
```

This approach ensures Docker can find the JAR file by setting the correct build context and maintaining the file paths relative to that context.